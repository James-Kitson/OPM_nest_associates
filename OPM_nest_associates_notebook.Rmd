---
title: "R Notebook"
output: html_notebook
---

#OPM Sanger processing

###This [R Markdown](http://rmarkdown.rstudio.com) notebook has been written to outline the steps taken to quality trim and merge sanger sequences for OAK Processionary Moth nest associates. The code used here draws heavily on the [sangeranalyseR](https://github.com/roblanf/sangeranalyseR) vignette provided by [Robert Lanfear](http:www.robertlanfear.com).

##Part one - Set up the libraries we need.
We're going to be using a library called [sangeranalyseR](https://github.com/roblanf/sangeranalyseR) so that the process is more documented and reproducible compared to the usual trimming and merging by eye performed using Geneious, FinchTV or similar programs. There are quite a few required libraries here but the script called [installs_for_sangerseqR.R](https://github.com/James-Kitson/OPM_nest_associates/blob/master/installs_for_sangerseqR.R) contains all the relevant commands.

```{r}
#Load the library we need
library(sangerseqR)
```

## Part two - Make group sequences by sample
We will be partially automating the trimming and merging processes as there's quite a few to deal with. For this, we're going to be using the ```make.readsets``` approach instead of the ```make.consensus.seqs``` approach which hides a lot of the detail I want to show here.

```{r}
#Define the folder containing the .ab1 sequences
input.folder<-"ab1_sequences/"

#Define the suffixes that denote the sequence direction
forward.suffix<-"_HCO2198puc.ab1"
reverse.suffix<-"_LCO1490puc.ab1"

#Make the readsets using the suffixes
rs<-make.readsets(input.folder, forward.suffix, reverse.suffix)
rs$readsets
rs$read.summaries
```


