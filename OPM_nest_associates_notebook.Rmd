---
title: "R Notebook"
output: html_notebook
---

#OPM Sanger processing

###This [R Markdown](http://rmarkdown.rstudio.com) notebook has been written to outline the steps taken to quality trim and merge sanger sequences for Oak Processionary Moth nest associates. The code used here draws heavily on the [sangeranalyseR](https://github.com/roblanf/sangeranalyseR) vignette provided by [Robert Lanfear](http:www.robertlanfear.com).

##Part one - Set up the libraries we need.
We're going to be using a library called [sangeranalyseR](https://github.com/roblanf/sangeranalyseR) so that the process is more documented and reproducible compared to the usual trimming and merging by eye performed using Geneious, FinchTV or similar programs. There are quite a few required libraries here but the script called [installs_for_sangerseqR.R](https://github.com/James-Kitson/OPM_nest_associates/blob/master/installs_for_sangerseqR.R) contains all the relevant commands.

```{r}
#Clear the workspace
rm(list=ls())
#Load the library we need
library(sangeranalyseR)
```

## Part two - Make group sequences by sample
We will be automating the trimming and merging processes as there's quite a few to deal with. For this, we're going to be using the ```make.consensus.seqs``` approach.

```{r}
#Define the folder containing the .ab1 sequences
input.folder<-"ab1_sequences/"

#Define the suffixes that denote the sequence direction
forward.suffix<-"_HCO2198puc.ab1"
reverse.suffix<-"_LCO1490puc.ab1"

#Make the readsets using the suffixes and only keep trimmed sequences longer than 250bp
consensus.seqs<-make.consensus.seqs(input.folder, forward.suffix, reverse.suffix, trim=TRUE, min.length=250)

#This outputs the read summaries
consensus.seqs$read.summaries

#This outputs the consensus sequence summaries
consensus.seqs$consensus.summaries

#This outputs the actual sequences
consensus.seqs$consensus.sequences

#This outputs the aligned sequences
BrowseSeqs(consensus.seqs$consensus.alignment)
```



